---
stand: 2025-11-14 21:48
update: Repository scan for inline PowerShell `-Command` occurrences. Candidate list for review and remediation planning.
checks: n/a
---

Inline `-Command` Candidate Report
=================================

Kurzbeschreibung
----------------
Dieser Report listet repo-weite Fundstellen von PowerShell- bzw. `-Command`-Vorkommen, bewertet sie grob und gibt Empfehlungen, bevor Änderungen vorgenommen werden (STOP vor Write).

Methodik
--------
- Suche (Regex): `-Command\b` über alle Dateien.
- Fokus: Nicht generierte Dateien (virtuelle Umgebungen, site-packages) und konfigurierbare Einträge.

Datum: 2025-11-14 21:48

Actionable Candidates
---------------------
(Prüfung empfohlen: Konvertieren zu `pwsh -File <script.ps1>` oder dokumentieren warum Inline-`-Command` gerechtfertigt ist.)

- `githooks/pre-commit`
  - Beispiel: `pwsh -NoProfile -ExecutionPolicy Bypass -Command "& { $ErrorActionPreference='Stop';`
  - Grund: Hook startet komplexe Blöcke via `-Command` → besser als `-File` wrapper machen für Robustheit und Quoting.
  - Empfehlung: Extrahieren des Blockes in `scripts/hooks/pre-commit.ps1` und im Hook `pwsh -NoProfile -ExecutionPolicy Bypass -File scripts/hooks/pre-commit.ps1` aufrufen.

- `novapolis-dev/logs/open-case-terminal-multi-root-20251103.md` (Log / Repro)
  - Beispiel: `pwsh -NoProfile -Command 'Get-Date -Format 'yyyy-MM-dd HH:mm''` → dokumentierter Fail/Quote-Problem.
  - Grund: Demonstriert Quote-Probleme in inline usage.
  - Empfehlung: Convert sample commands in docs to `pwsh -NoProfile -Command "Get-Date -Format 'yyyy-MM-dd HH:mm' | Write-Output"` (or better, use `pwsh -File` wrappers in tasks).

- `novapolis-rp/coding/tools/diagnostics/with_lock.ps1`
  - Beispiel: `pwsh -NoProfile -ExecutionPolicy Bypass -Command $Command`
  - Grund: Script intentionally proxies arbitrary commands; high-risk but may be intended.
  - Empfehlung: Keep but document allowed/escaped shapes; consider explicit wrapper entry for common operations.

- `Backups/tasks.json.backup-2025-11-01` and `Backups/tasks.json.bak`
  - Fund: many `"-Command",` entries and full JSON with inlined commands.
  - Grund: Backups contain historical `tasks.json` with inline `-Command` usages.
  - Empfehlung: Archive is fine; if restoring to `.vscode/tasks.json`, convert to wrappers first.

- `scripts/snapshot_write_lock.ps1` and `scripts/snapshot_gate.ps1`
  - Beispiel: `$ts = & $shell -NoProfile -Command "Get-Date -Format 'yyyy-MM-dd HH:mm'"`
  - Grund: Using `-Command` to call simple `Get-Date` via chosen shell binary variable.
  - Empfehlung: Acceptable as single-command use; optionally replace with direct `Get-Date` when executed under pwsh. Document rationale.

Informational / Documentation Matches
-------------------------------------
(Erfordern normalerweise keine changes; enthalten examples or docs.)

- `.github/copilot-instructions.md`
  - Enthält inline `pwsh -Command` examples used as guidance. Keep as-is (documentation). No code change.

- `TODO/WORKSPACE_STATUS/DONELOG` references
  - Historical notes about previous conversions; informational only.

Likely-Ignored (vendor / virtualenv)
-----------------------------------
- Files under `.venv/` and many site-packages contain the string `command` or `-command` as part of third-party code. These are not actionable and are excluded from remediation.

Examples (non-exhaustive)
-------------------------
- `extensions.status.txt` contains local VS Code command invocations (generated file) — ignore for repo remediation.
- Many matches come from `.venv` packages (pip install) — ignore.

Summary & Next Steps
--------------------
- Priorität 1 (convert): `githooks/pre-commit` and any active `.vscode/tasks.json` entries (if present) that still use inline `-Command` in the active workspace.
- Priorität 2 (document/review): `novapolis-rp/coding/tools/diagnostics/with_lock.ps1` (proxy wrapper) and `scripts/snapshot_*` (single Get-Date calls) — decide per-case.
- Priorität 3 (archive): Backups containing `-Command` are historical; ensure they are not restored without conversion.

Empfohlener Ablauf (safe)
-------------------------
1. Review `githooks/pre-commit` and extract block to `scripts/hooks/pre-commit.ps1` (STOP before write).
2. Re-scan `.vscode/tasks.json` (active one) and confirm no live `-Command` chains remain.
3. For proxy scripts (`with_lock.ps1`) add explicit documentation explaining safe usage and escaping.
4. Commit small, focused patches with one change per PR and include receipts.

Generated by: repo-wide grep `-Command` (regex) on 2025-11-14 21:48.

